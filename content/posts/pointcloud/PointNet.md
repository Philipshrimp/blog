---
title: "PointNet"
date: 2023-11-06T23:11:21+09:00
author:
  name: Sunho Kim
menu:
  sidebar:
    name: PointNet 논문 리뷰
    identifier: pointnet-review
    parent: point-cloud-processing
    weight: 1
categories:
  - Point Cloud
tags:
  - Deep Learning
  - Neural Network
  - Point Cloud
  - Point Cloud Processing
  - PointNet
draft: false
---
### Intro
컨볼루션 신경망(CNN)은 정규적인 형태의 데이터 포맷을 요구하는 것으로 잘 알려져 있으며, 이는 CNN이 데이터의 공간적 계층 구조를 학습할 때 슬라이딩 윈도우 기법을 사용해 로컬 특징을 추출하고, 단일 커널로 전체 영역에 걸쳐 가중치를 공유하는 방식에서 비롯된다. 그러나 3차원 데이터는 대체로 정규적이지 않은 경우가 많고, 포인트 클라우드나 메쉬 같은 데이터 형식이 이에 해당한다. 이를 처리하기 위해, 과거에는 데이터를 복셀화하거나 다양한 뷰포인트에 해당하는 이미지 세트로 투영하는 방법이 사용되었으나, 이 방식은 불필요한 공간까지 표현해 연산을 비효율적으로 만드는 단점이 있다. 더욱이, 포인트 클라우드는 순서에 무관한(permutation invariant) 특성을 가지고 있다. 딥 러닝 네트워크 중, 멀티레이어 퍼셉트론(MLP)은 이와 유사한 구조를 가질 수 있지만, CNN이나 순환 신경망(RNN)은 이러한 특성을 갖지 못해, 3차원 데이터에 적용하기에 제약이 있다.
{{< vs 3>}}

PointNet은 포인트 클라우드 데이터를 직접 처리할 수 있는 딥러닝 아키텍처를 제안한다. 이 구조는 포인트 클라우드를 직접 입력으로 받아, 객체의 분류나 세그멘테이션과 같은 결과를 도출할 수 있는 통합적인 방식을 제공한다. PointNet은 개별 포인트에 대해 위치 정보만을 초기 입력으로 사용하는 것으로 보이며, 필요한 경우 노말이나 추가적인 특징 계산을 통해 더 풍부한 데이터 표현을 모델에 통합할 수 있다. 
{{< vs 3>}}

PointNet의 핵심은 max pooling 연산에 있다. 이를 통해 네트워크는 가장 유용한 포인트를 선별하고, 이들을 목적에 맞게 인코딩하여 최종적으로 각 클래스나 세그먼트에 맞는 글로벌 특징을 fully connected 레이어에서 출력한다. 이 아키텍처는 심지어 희소한 피쳐 포인트의 집합에서도 유의미한 결과를 도출할 수 있는 강력한 능력을 보여준다.
{{< vs 3>}}

요약하자면, PointNet은 다음의 Key contribution을 기반으로 하는 방법론을 제안한다.

- 3차원 공간에 있는 unordered point set을 입력으로 받을 수 있는 네트워크 제안
- Classification, segmentation 등의 분야에서 활용 가능한 아웃풋 도출
- 실험을 통해 안정성과 효율성 검증
{{< vs 3>}}


### Problem definition
PointNet은 N개의 포인트로 구성된 3차원 포인트 클라우드에서 위치 정보만을 활용하는 것에 초점을 맞추고 있다. 각 포인트는 3차원 좌표를 가지며, 추가적인 특성 없이도 이 좌표 정보만으로 물체 인식이나 공간의 세그멘테이션을 수행할 수 있다는 가정 하에 연구가 진행된다.
{{< vs 3>}}

네트워크의 구조도는 그림에서 보다시피 다음과 같은 흐름으로 구성되어 있다.
{{< vs 3>}}

1. **입력**: 구조도는 n개의 포인트로 구성된 포인트 클라우드를 입력으로 받는다. 각 포인트는 x, y, z 좌표를 포함할 수 있으며, 추가적인 특성(예: 색상, 강도 등)을 포함할 수 있다.
2. **특성 변환(Feature Transform)**: 입력 포인트는 특성 변환 네트워크를 거치는데, 이는 데이터의 공간적 구조를 학습하여 각 포인트의 고차원 특성을 추출한다. 이 단계는 네트워크가 입력 데이터의 순서에 무관하게 동작하도록 함으로써 permutation invariance를 보장한다.
3. **최대 풀링(Max Pooling)**: 추출된 고차원 특성들은 최대 풀링 연산을 통해 집계되어 전체 포인트 클라우드에 대한 글로벌 특성을 생성한다. 이 글로벌 특성은 분류를 위한 핵심 정보를 포함한다.
4. **세그멘테이션(Segmentation)**: 세그멘테이션을 위해서는 최대 풀링을 통해 얻은 글로벌 특성을 각 포인트의 로컬 특성과 결합(concatenate)한다. 이를 통해 각 포인트가 전체 구조 내에서 어떤 역할을 하는지를 결정할 수 있다.
5. **MLP(Multi-Layer Perceptron)**: 구조는 MLP 기반으로, 여러 층을 통해 데이터를 처리한다. 각 층에서는 일련의 가중치와 비선형 활성화 함수를 사용하여 데이터를 변환한다.
6. **Batch Normalization + ReLU**: 모든 레이어에는 일관되게 배치 정규화(batch normalization)와 ReLU 활성화 함수가 적용되어, 학습의 안정성과 수렴 속도를 개선한다.
7. **분류(Classification) 파트**: 최종적으로 분류를 위한 파트에서는 드랍아웃(dropout)을 사용하여 과적합을 방지하고, 네트워크의 일반화 능력을 향상시킨다.
{{< vs 3>}}


### 포인트 클라우드의 주요 특징
#### 1. Unordered
포인트 클라우드 데이터는 일반적으로 순서가 지정되지 않은 구조를 갖는다. 이는 데이터를 처리할 때, 주어진 N개의 포인트에 대해 이론상 N! 가지의 가능한 순열이 존재할 수 있음을 의미한다. 이러한 특성은 데이터를 네트워크에 공급하는 과정에서 다양한 순서로 데이터를 제공할 수 있다는 것을 나타낸다. 그러므로, 포인트 클라우드를 다루는 알고리즘은 이러한 비순서성을 관리할 수 있는 방법이 필요하다.
{{< vs 3>}}

#### 2. Interaction Among Points

포인트 클라우드 내의 포인트들은 물리적 공간에 위치함으로써 서로 상호작용한다고 볼 수 있다. 인접한 포인트들은 종종 유사한 특성을 공유하며, 이를 통해 서브셋을 구성할 수 있다. 이러한 로컬 구조를 캡처하는 것은 네트워크 설계에 있어 중요한 요소인데, 지역적인 상호작용뿐만 아니라 이들이 글로벌한 맥락에서 어떻게 조합되고 상호 연결되는지를 이해하는 것이 중요하며, 이는 CNN이 로컬 패턴을 이해한 후 점차적으로 글로벌한 특성을 추출하는 방식과 유사하다.
{{< vs 3>}}

#### 3. Invariance Under Transformations

포인트 클라우드 데이터는 기하학적 변환에 대해 불변성을 가져야 한다(Permutation invariant). 실제 세계의 객체를 모델링할 때, 학습된 표현은 회전, 이동 등의 기하학적 변환에 의해 영향을 받지 않아야 한다. 이것은 변환에 불변하는 특성 추출이 중요한 이유를 나타내며, 딥러닝 모델은 이러한 변환에 강인한 방식으로 정보를 학습하고 추론할 수 있어야 한다.
{{< vs 3>}}


### PointNet의 핵심 모듈
#### 1. Max pooling

포인트 클라우드 데이터를 처리할 때 입력 데이터의 순서에 의존하지 않는, 즉 permutation invariant한 특성을 유지하는 것이 필요하다. 이를 달성하기 위한 전략을 찾고자, PointNet은 다음과 같은 방법들을 시도한다.
{{< vs 3>}}

##### 1. 입력 포인트의 정렬

데이터를 canonical order로 정렬하는 방법은 입력 데이터가 어떤 순서로 주어져도 항상 동일한 순서로 정렬하여 일관성을 유지하는 전략다. 이는 데이터의 permutation invariance를 보장하기 위해 사용되지만, 모든 경우의 수를 커버할 수 없는 실질적인 한계가 있다.
{{< vs 3>}}

정렬 방법은 저차원에서는 효율성이 있을 수는 있겠지만, 고차원 공간에서는 특정한 순서를 만드는 것이 어렵고 불안정할 수 있다. 이론적으로는 물론 가능하다 할지라도, 고차원 공간에서 포인트의 변동에 대해 안정적인 순서를 정의하는 것은 실질적으로 어려운 문제다. 이는 고차원 공간의 데이터를 1차원 실제 라인에 대응시키는 전단사 함수(일대일 대응)를 찾는 것과 유사한 문제인데, 이는 복잡한 데이터 구조에서는 실현하기 매우 어렵다.
{{< vs 3>}}

실제로 실험을 통해 정렬된 포인트 셋을 MLP(Multi-Layer Perceptron)에 입력했을 때 성능이 떨어지는 것을 확인하였고, 정렬을 하지 않는 것이 더 나은 결과를 가져왔음을 보여주었다. 
{{< vs 3>}}

##### 2. RNN 사용

순서에 민감한 RNN(Recurrent Neural Network)을 사용하여 포인트 클라우드를 시퀀스 데이터로 간주하고 학습하는 방법이다. 이 접근법은 트레이닝 데이터를 모든 가능한 순열로 증강하여 RNN이 순서에 불변하는 특성을 학습할 수 있도록 한다. 그러나 이는 계산적으로 매우 비효율적이며 실제로 사용하기 어려울 수 있다.
{{< vs 3>}}

여기서는 데이터의 임의의 순열을 고려하여 네트워크가 입력 순서에 불변하는 출력을 생성할 수 있기를 기대하며 출발하는데, 'Order Matters'논문에서는 입력 순서가 결과에 영향을 미칠 수 있음을 보여주며, RNN이 입력 순서에 완전히 불변하지 않다는 점을 지적한다. 특히, RNN은 짧은 시퀀스에 대해서는 순서에 강건할 수 있지만, 포인트 클라우드와 같이 매우 많은 수의 입력을 처리할 때는 그러한 강건성이 떨어질 가능성이 크다. 이는 포인트 클라우드 데이터에 대한 RNN의 적용이 제한적일 수 있음을 시사하며, 실험을 통해 이러한 한계를 확인하였다. 
{{< vs 3>}}

결론적으로, RNN을 포인트 클라우드 데이터에 적용하는 것은 이론적으로 매력적인 아이디어일 수 있으나, 실제로는 입력의 순서에 완전히 불변하는 모델을 구현하는 데 있어서는 한계가 있음을 인식해야 한다.
{{< vs 3>}}

##### 3. Symmetric function 사용

가장 간단하고 효과적인 방법은 입력 벡터들을 symmetric function을 통해 aggregate하는 것일 것이다. 대칭 함수는 입력 벡터의 순서와 상관없이 항상 동일한 출력 벡터를 생성한다. 예를 들어, max pooling은 입력 벡터들의 최대 값을 선택하여 순서에 관계없이 동일한 결과를 낼 수 있는 대칭 함수의 한 예로 볼 수 있다. 이 방법이 포인트 클라우드 데이터의 permutation invariance 특성을 보존하는 데 매우 적합하다고 판단하고 논문에서는 이를 채택했다.
{{< vs 3>}}

(식 첨부)
{{< vs 3>}}

*x*는 *n*개의 포인트 위치를 나타내며, ℎ는 각 단일 포인트에 적용되는 함수로 보인다. ℎ가 각 포인트를 개별적으로 처리하고, *k*<*n*이기 때문에 ℎ는 차원을 축소하는 역할을 하는 것으로 보인다. 다시 말하면, ℎ는 각 포인트를 더 낮은 차원의 표현으로 변환하는 역할을 한다. 함수 *g*는 ℎ에 의해 변환된 *n*개의 축소된 표현을 기반으로 하여, 이들을 합쳐서 하나의 응집된 결과물을 만들어내는 역할을 한다. 
{{< vs 3>}}

결과적으로, *f*는 *g*와 ℎ의 조합을 통해 근사화될 수 있으며, 이러한 함수들의 구성은 종종 더 복잡한 구조나 패턴을 모델링하기 위해 사용된다. *f*가 전체 데이터 세트의 특성을 표현하는 함수라면, ℎ는 개별 데이터 포인트를 처리하고, *g*는 이러한 처리된 정보를 종합하여 전체적인 결과를 도출하는 함수로 해석할 수 있다.
{{< vs 3>}}

논문에서는 실험을 통해 함수 f를 구성하는 ℎ와 g에 대한 구체적인 설계를 하였다. 
{{< vs 3>}}

- ***h* 함수의 정의**: 여기서 ℎ는 Multi-Layer Perceptron (MLP)으로 근사화되고 있다. MLP는 각 데이터 포인트에 독립적으로 적용되며, 이는 학습을 통해 각 포인트의 특성을 나타내는 방식으로 최적화가 이루어진다. MLP가 비선형적인 관계를 모델링할 수 있고, 다층 구조를 통해 복잡한 패턴을 학습할 수 있기 때문에 MLP를 사용했다.
- ***g* 함수의 정의**: *g*는 단변수 함수들, 즉 ℎ에 의해 처리된 데이터 포인트들의 결과물을 입력으로 max pooling을 사용한다. Max pooling은 입력된 여러 데이터 포인트의 특성 중 가장 두드러진 특성(최대값)을 선택하는 과정으로, 이는 입력 데이터의 순서에 불변적인 특성을 가진다. 즉, 어떤 순서로 데이터가 입력되든 가장 강한 신호를 유지한다.
{{< vs 3>}}

이런 방식으로, g는 h를 이용하여 다수의 데이터 포인트에서 중요한 특성을 유지하며, ℎ에 의해 생성된 특성들을 통합한다. 이 모듈은 각 포인트의 정보를 독립적으로 처리한 후, 그 결과를 합치는 방식으로 전체 데이터 세트에 대한 응집된 표현을 생성한다. 이러한 접근 방식은 특히 순서에 민감하지 않은 문제에서 유용하며, 입력 데이터의 중요한 특성을 보존하면서도 변환의 순서에 대한 영향을 최소화할 수 있다..
{{< vs 3>}}
